var f=o=>{throw TypeError(o)};var y=(o,e,t)=>e.has(o)||f("Cannot "+t);var c=(o,e,t)=>(y(o,e,"read from private field"),t?t.call(o):e.get(o)),p=(o,e,t)=>e.has(o)?f("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(o):e.set(o,t),B=(o,e,t,n)=>(y(o,e,"write to private field"),n?n.call(o,t):e.set(o,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const g of s.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&n(g)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();class k{constructor(e,t){this.id=crypto.randomUUID(),this.name=e,this.email=t}getRole(){return"User"}}class E extends k{constructor(e,t){super(e,t)}getRole(){return"Admin"}}const l=new WeakMap;class v extends k{constructor(e,t){super(e,t);const n=JSON.parse(localStorage.getItem("borrowedBooks"))||[];l.set(this,n)}borrowBook(e){const t=l.get(this);t.push(e),e.isAvailable=!1,localStorage.setItem("borrowedBooks",JSON.stringify(t))}returnBook(e){const t=l.get(this);t.pop(e),localStorage.setItem("returnedBooks",JSON.stringify(t))}getBorrowedBooks(){return l.get(this)}getRole(){return"Member"}}class I{constructor(e,t,n){this.id=crypto.randomUUID(),this.title=e,this.author=t,this.genre=n,this.isAvailable=!0}}var a;class L{constructor(){p(this,a);B(this,a,[])}addBook(e){c(this,a).push(e)}getAvailableBooks(){return c(this,a).filter(e=>e.isAvailable)}getAllBooks(){return c(this,a)}getBookById(e){return c(this,a).find(t=>t.id===e)}}a=new WeakMap;const S=document.getElementById("userSwitcher"),A=document.getElementById("bookSection"),M=document.getElementById("borrowedSection"),w=document.getElementById("bookForm"),b=document.getElementById("bookList"),h=document.getElementById("borrowedList");let i=new v("John Doe","john@email.com");const u=new L;S.addEventListener("change",o=>{const e=o.target.value;i=e==="admin"?new E("Alice","alice@email.com"):new v("John Doe","john@email.com"),A.style.display=e==="admin"?"block":"none",M.style.display=e==="member"?"block":"none",d(),m()});w.addEventListener("submit",o=>{o.preventDefault();const e=document.getElementById("title").value,t=document.getElementById("author").value,n=document.getElementById("genre").value,r=new I(e,t,n);u.addBook(r),d(),w.reset()});function d(){b.innerHTML="",u.getAllBooks().forEach(o=>{const e=document.createElement("li");e.className="bg-white p-4 rounded shadow flex justify-between items-center";let t="";i.getRole()==="Member"&&o.isAvailable?t=`<button class="bg-green-500 text-white px-3 py-1 rounded" data-action="borrow" data-id="${o.id}">Borrow</button>`:i.getRole()==="Admin"&&(t=`<span class="text-sm text-gray-500">${o.isAvailable?"Available":"Borrowed"}</span>`),e.innerHTML=`
            <div>
              <strong>${o.title}</strong> by ${o.author} <em>(${o.genre})</em>
            </div>
            ${t}
        `,b.appendChild(e)})}function m(){if(h.innerHTML="",i.getRole()!=="Member")return;i.getBorrowedBooks().forEach(e=>{const t=document.createElement("li");t.className="bg-yellow-100 p-4 rounded shadow flex justify-between items-center",t.innerHTML=`
        <div>
            ${e.title} by ${e.author}
        </div>
        <button class="bg-red-500 text-white px-3 py-1 rounded" data-action="return" data-id="${e.id}">Return</button>
    `,h.appendChild(t)})}b.addEventListener("click",o=>{if(o.target.tagName==="BUTTON"){const e=o.target.getAttribute("data-id"),t=o.target.getAttribute("data-action"),n=u.getBookById(e);t==="borrow"&&i.getRole()==="Member"&&n.isAvailable&&(i.borrowBook(n),d(),m())}});h.addEventListener("click",o=>{if(o.target.tagName==="BUTTON"){const e=o.target.getAttribute("data-id"),t=o.target.getAttribute("data-action"),n=u.getBookById(e);t==="return"&&i.getRole()==="Member"&&(i.returnBook(n),console.log("return"))}d(),m()});A.style.display="none";d();m();
